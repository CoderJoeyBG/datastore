<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roblox DataStore Security Guide</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap');
        
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --danger-gradient: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
            --success-gradient: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
            --warning-gradient: linear-gradient(135deg, #ffd89b 0%, #19547b 100%);
            --glass-bg: rgba(255, 255, 255, 0.15);
            --glass-border: rgba(255, 255, 255, 0.2);
            --text-primary: #2d3748;
            --text-secondary: #718096;
            --shadow-soft: 0 8px 32px rgba(0, 0, 0, 0.12);
            --shadow-medium: 0 12px 40px rgba(0, 0, 0, 0.15);
            --shadow-strong: 0 20px 60px rgba(0, 0, 0, 0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.7;
            color: var(--text-primary);
            background: var(--primary-gradient);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.03)" stroke-width="1"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            pointer-events: none;
            z-index: -1;
        }

        .floating-shapes {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .shape {
            position: absolute;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
        }

        .shape:nth-child(1) { width: 80px; height: 80px; top: 20%; left: 10%; animation-delay: 0s; }
        .shape:nth-child(2) { width: 120px; height: 120px; top: 60%; right: 10%; animation-delay: 2s; }
        .shape:nth-child(3) { width: 60px; height: 60px; bottom: 30%; left: 70%; animation-delay: 4s; }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .header {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 60px 40px;
            margin-bottom: 40px;
            box-shadow: var(--shadow-strong);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: shimmer 8s linear infinite;
        }

        @keyframes shimmer {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .header-content {
            position: relative;
            z-index: 2;
        }

        .header h1 {
            font-size: 3.5rem;
            font-weight: 700;
            color: white;
            margin-bottom: 20px;
            text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            letter-spacing: -0.02em;
        }

        .header .subtitle {
            font-size: 1.25rem;
            color: rgba(255, 255, 255, 0.9);
            max-width: 700px;
            margin: 0 auto;
            font-weight: 400;
            line-height: 1.6;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: white;
            display: block;
        }

        .stat-label {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .warning-banner {
            background: var(--danger-gradient);
            color: white;
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 40px;
            box-shadow: var(--shadow-medium);
            position: relative;
            overflow: hidden;
        }

        .warning-banner::before {
            content: '⚠️';
            position: absolute;
            right: 30px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 4rem;
            opacity: 0.2;
        }

        .warning-banner h2 {
            font-size: 1.5rem;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .warning-banner p {
            font-size: 1.05rem;
            line-height: 1.6;
            max-width: 90%;
        }

        .nav-container {
            position: sticky;
            top: 20px;
            z-index: 100;
            margin-bottom: 40px;
        }

        .nav {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--shadow-soft);
        }

        .nav ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }

        .nav a {
            color: white;
            text-decoration: none;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 500;
            font-size: 0.95rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .nav a:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .section {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 40px;
            margin-bottom: 40px;
            box-shadow: var(--shadow-medium);
            position: relative;
        }

        .section h2 {
            font-size: 2.25rem;
            font-weight: 700;
            color: white;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .section h3 {
            font-size: 1.5rem;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.95);
            margin: 35px 0 20px 0;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .section p {
            color: rgba(255, 255, 255, 0.85);
            font-size: 1.05rem;
            line-height: 1.7;
            margin-bottom: 20px;
        }

        .impact-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border-radius: 25px;
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .high-risk {
            background: linear-gradient(135deg, #ff4757, #ff3742);
            color: white;
            box-shadow: 0 4px 15px rgba(255, 71, 87, 0.4);
        }

        .medium-risk {
            background: linear-gradient(135deg, #ffa726, #ff9800);
            color: white;
            box-shadow: 0 4px 15px rgba(255, 167, 38, 0.4);
        }

        .low-risk {
            background: linear-gradient(135deg, #42a5f5, #2196f3);
            color: white;
            box-shadow: 0 4px 15px rgba(66, 165, 245, 0.4);
        }

        .example-container {
            display: grid;
            gap: 25px;
            margin: 25px 0;
        }

        .vulnerability-example {
            background: linear-gradient(135deg, rgba(255, 71, 87, 0.1), rgba(238, 90, 82, 0.05));
            border: 1px solid rgba(255, 71, 87, 0.3);
            border-radius: 16px;
            padding: 25px;
            position: relative;
        }

        .patch-example {
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.1), rgba(67, 160, 71, 0.05));
            border: 1px solid rgba(76, 175, 80, 0.3);
            border-radius: 16px;
            padding: 25px;
            position: relative;
        }

        .example-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .vulnerability-example .example-header {
            color: #ff4757;
        }

        .patch-example .example-header {
            color: #4caf50;
        }

        .code-block {
            background: #0d1117;
            color: #f0f6fc;
            padding: 25px;
            border-radius: 12px;
            overflow-x: auto;
            margin: 15px 0;
            border: 1px solid #30363d;
            position: relative;
            font-family: 'JetBrains Mono', 'Fira Code', monospace;
            box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .code-block::before {
            content: attr(data-lang);
            position: absolute;
            top: 12px;
            right: 20px;
            background: linear-gradient(135deg, #58a6ff, #1f6feb);
            color: white;
            padding: 4px 12px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }

        .code-block code {
            display: block;
            font-size: 0.95rem;
            line-height: 1.6;
            white-space: pre;
        }

        /* Syntax highlighting */
        .keyword { color: #ff7b72; font-weight: 600; }
        .string { color: #a5d6ff; }
        .comment { color: #8b949e; font-style: italic; }
        .function { color: #d2a8ff; }
        .number { color: #79c0ff; }
        .operator { color: #ff7b72; }
        .variable { color: #ffa657; }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .feature-card {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 25px;
            backdrop-filter: blur(10px);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
        }

        .feature-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-bottom: 20px;
            background: var(--success-gradient);
        }

        .feature-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: white;
            margin-bottom: 10px;
        }

        .feature-description {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.6;
        }

        .footer {
            text-align: center;
            padding: 50px 20px;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            margin-top: 40px;
        }

        .footer-content {
            max-width: 600px;
            margin: 0 auto;
        }

        .footer h3 {
            color: white;
            font-size: 1.5rem;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .footer p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1rem;
            line-height: 1.7;
            margin-bottom: 10px;
        }

        .security-tips {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .security-tip {
            background: rgba(255, 255, 255, 0.1);
            border-left: 4px solid #4caf50;
            padding: 20px;
            border-radius: 8px;
        }

        .security-tip h4 {
            color: #4caf50;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .security-tip p {
            color: rgba(255, 255, 255, 0.85);
            font-size: 0.95rem;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px 15px;
            }
            
            .header {
                padding: 40px 25px;
            }
            
            .header h1 {
                font-size: 2.5rem;
            }
            
            .section {
                padding: 25px;
            }
            
            .nav ul {
                flex-direction: column;
                align-items: stretch;
            }
            
            .nav a {
                text-align: center;
            }

            .stats-grid {
                display: none;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="floating-shapes">
        <div class="shape"></div>
        <div class="shape"></div>
        <div class="shape"></div>
    </div>

    <div class="container">
        <div class="header">
            <div class="header-content">
                <h1>Roblox DataStore Security</h1>
                <p class="subtitle">Learn how to protect your game's data from common exploits and secure your DataStore operations with practical examples and solutions</p>
                

            </div>
        </div>



        <div class="nav-container">
            <nav class="nav">
                <ul>
                    <li><a href="#type-validation">🛡️ Type Validation</a></li>
                    <li><a href="#string-attacks">🔤 String Attacks</a></li>
                    <li><a href="#size-limits">📏 Size Limits</a></li>
                    <li><a href="#advanced-attacks">🎯 Advanced Vectors</a></li>
                    <li><a href="#framework">🔧 Complete Framework</a></li>
                    <li><a href="#testing">🧪 Testing Suite</a></li>
                </ul>
            </nav>
        </div>

        <section class="section" id="type-validation">
            <h2>🛡️ Type Validation Exploits</h2>
            
            <h3>Instance/Userdata Injection <span class="impact-badge high-risk">🔴 Critical Risk</span></h3>
            <p>Attackers inject Roblox instances or userdata objects into remote events, causing DataStore operations to fail and preventing legitimate player data from being saved. This can lead to permanent data loss and progression rollbacks.</p>

            <div class="example-container">
                <div class="vulnerability-example">
                    <div class="example-header">
                        🚨 Vulnerable Implementation
                    </div>
                    <div class="code-block" data-lang="Lua">
                        <code><span class="comment">-- Remote event handler without type checking</span>
<span class="keyword">local</span> <span class="function">buyItemEvent</span> = ReplicatedStorage.BuyItem

buyItemEvent.OnServerEvent:<span class="function">Connect</span>(<span class="keyword">function</span>(player, itemData)
    <span class="comment">-- Dangerous: No validation of itemData structure</span>
    player.Data.Inventory[itemData.Name] = {
        <span class="string">["Color"]</span> = itemData.Color,  <span class="comment">-- Exploiter passes workspace</span>
        <span class="string">["Price"]</span> = itemData.Price,  <span class="comment">-- Could be any value</span>
        <span class="string">["Rarity"]</span> = itemData.Rarity <span class="comment">-- No type checking</span>
    }
    
    <span class="comment">-- This will fail when DataStore tries to save workspace object</span>
    <span class="function">savePlayerData</span>(player)
<span class="keyword">end</span>)

<span class="comment">-- Exploiter's attack payload</span>
BuyItem:<span class="function">FireServer</span>({
    Name = <span class="string">"Rare Sword"</span>,
    Color = <span class="variable">workspace</span>, <span class="comment">-- Instance object - cannot be saved!</span>
    Price = <span class="number">1000</span>,
    Rarity = <span class="string">"Legendary"</span>
})</code>
                    </div>
                </div>

                <div class="patch-example">
                    <div class="example-header">
                        ✅ Secure Implementation
                    </div>
                    <div class="code-block" data-lang="Lua">
                        <code><span class="comment">-- Robust type validation system</span>
<span class="keyword">local</span> <span class="function">validateItemData</span> = <span class="keyword">function</span>(data)
    <span class="comment">-- Check if data is a table</span>
    <span class="keyword">if</span> <span class="function">type</span>(data) ~= <span class="string">"table"</span> <span class="keyword">then</span>
        <span class="keyword">return</span> <span class="keyword">false</span>, <span class="string">"Data must be a table"</span>
    <span class="keyword">end</span>
    
    <span class="comment">-- Validate required fields with strict typing</span>
    <span class="keyword">if</span> <span class="function">type</span>(data.Name) ~= <span class="string">"string"</span> <span class="keyword">then</span>
        <span class="keyword">return</span> <span class="keyword">false</span>, <span class="string">"Name must be string"</span>
    <span class="keyword">end</span>
    
    <span class="comment">-- Color3 validation (common attack vector)</span>
    <span class="keyword">if</span> <span class="function">typeof</span>(data.Color) ~= <span class="string">"Color3"</span> <span class="keyword">then</span>
        <span class="keyword">return</span> <span class="keyword">false</span>, <span class="string">"Color must be Color3"</span>
    <span class="keyword">end</span>
    
    <span class="comment">-- Number validation</span>
    <span class="keyword">if</span> <span class="function">type</span>(data.Price) ~= <span class="string">"number"</span> <span class="operator">or</span> data.Price < <span class="number">0</span> <span class="keyword">then</span>
        <span class="keyword">return</span> <span class="keyword">false</span>, <span class="string">"Price must be positive number"</span>
    <span class="keyword">end</span>
    
    <span class="keyword">return</span> <span class="keyword">true</span>
<span class="keyword">end</span>

buyItemEvent.OnServerEvent:<span class="function">Connect</span>(<span class="keyword">function</span>(player, itemData)
    <span class="keyword">local</span> isValid, errorMsg = <span class="function">validateItemData</span>(itemData)
    
    <span class="keyword">if</span> <span class="operator">not</span> isValid <span class="keyword">then</span>
        <span class="function">warn</span>(<span class="string">"Invalid item data from"</span>, player.Name, <span class="string">":"</span>, errorMsg)
        <span class="keyword">return</span> <span class="comment">-- Reject malicious input</span>
    <span class="keyword">end</span>
    
    <span class="comment">-- Safe to process validated data</span>
    player.Data.Inventory[itemData.Name] = {
        Color = itemData.Color,
        Price = itemData.Price,
        Rarity = itemData.Rarity
    }
    
    <span class="function">savePlayerData</span>(player)
<span class="keyword">end</span>)</code>
                    </div>
                </div>
            </div>

            <div class="security-tips">
                <div class="security-tip">
                    <h4>🔍 Always Validate Types</h4>
                    <p>Never trust client input. Every parameter should be explicitly type-checked before processing.</p>
                </div>
                <div class="security-tip">
                    <h4>🚫 Reject Unknown Types</h4>
                    <p>Instances, userdata, and functions cannot be stored in DataStores and will cause save failures.</p>
                </div>
                <div class="security-tip">
                    <h4>⚡ Fail Fast</h4>
                    <p>Return early when validation fails to prevent processing malicious data.</p>
                </div>
            </div>
        </section>

        <section class="section" id="string-attacks">
            <h2>🔤 String-Based Attack Vectors</h2>
            
            <h3>Malformed UTF-8 Injection <span class="impact-badge high-risk">🔴 Critical Risk</span></h3>
            <p>DataStores cannot persist malformed UTF-8 byte sequences. Attackers exploit this by sending invalid UTF-8 strings through remotes, causing save operations to fail silently and preventing player progress from being stored.</p>

            <div class="example-container">
                <div class="vulnerability-example">
                    <div class="example-header">
                        🚨 Attack Examples
                    </div>
                    <div class="code-block" data-lang="Lua">
                        <code><span class="comment">-- Common malformed UTF-8 attack vectors</span>

<span class="comment">-- Attack 1: Direct byte injection</span>
ChangePetName:<span class="function">FireServer</span>({
    PetId = <span class="number">1</span>,
    PetName = <span class="string">"\255"</span> <span class="comment">-- Invalid UTF-8 byte</span>
})

<span class="comment">-- Attack 2: Complex byte sequences</span>
UpdateBillboard:<span class="function">InvokeServer</span>(
    workspace.MyHouse, 
    <span class="string">"\237\190\140"</span> <span class="comment">-- Malformed UTF-8 sequence</span>
)

<span class="comment">-- Attack 3: Mixed valid/invalid content</span>
SaveMessage:<span class="function">FireServer</span>(<span class="string">"Hello World \255 Invalid"</span>)

<span class="comment">-- Result: DataStore:SetAsync() fails, data rollback occurs</span></code>
                    </div>
                </div>

                <div class="patch-example">
                    <div class="example-header">
                        ✅ UTF-8 Validation Solution
                    </div>
                    <div class="code-block" data-lang="Lua">
                        <code><span class="comment">-- Comprehensive UTF-8 validation module</span>
<span class="keyword">local</span> StringValidator = {}

<span class="comment">-- Primary UTF-8 validation using utf8.len</span>
<span class="function">StringValidator.isValidUTF8</span> = <span class="keyword">function</span>(str)
    <span class="keyword">if</span> <span class="function">type</span>(str) ~= <span class="string">"string"</span> <span class="keyword">then</span>
        <span class="keyword">return</span> <span class="keyword">false</span>, <span class="string">"Input is not a string"</span>
    <span class="keyword">end</span>
    
    <span class="comment">-- utf8.len returns nil for invalid UTF-8</span>
    <span class="keyword">local</span> length = <span class="function">utf8.len</span>(str)
    <span class="keyword">if</span> length == <span class="keyword">nil</span> <span class="keyword">then</span>
        <span class="keyword">return</span> <span class="keyword">false</span>, <span class="string">"Contains invalid UTF-8 sequences"</span>
    <span class="keyword">end</span>
    
    <span class="keyword">return</span> <span class="keyword">true</span>, length
<span class="keyword">end</span>

<span class="comment">-- Advanced character filtering for international support</span>
<span class="function">StringValidator.containsSafeChars</span> = <span class="keyword">function</span>(str, allowUnicode)
    allowUnicode = allow
